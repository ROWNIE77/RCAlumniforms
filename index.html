<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alumni Form</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', Arial, sans-serif;
            margin: 0;
            padding: 0;
            position: relative;
            overflow-x: hidden;
        }
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url('https://raw.githubusercontent.com/ROWNIE77/RCAlumniforms/main/1.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            filter: blur(0px);
            z-index: -1;
        }
        form {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            max-width: 600px;
            margin: 40px auto;
            transform: translateY(20px);
            opacity: 0;
            animation: fadeInUp 0.5s ease-out forwards;
        }
        @keyframes fadeInUp {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        .logo {
            display: block;
            margin: 0 auto 20px;
            max-width: 150px;
            height: auto;
        }
      
        h2 {
            text-align: center;
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 20px;
            animation: fadeIn 1s ease-out;
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        label {
            display: block;
            margin: 15px 0 5px;
            font-weight: 500;
            animation: slideInLeft 0.5s ease-out;
        }
        @keyframes slideInLeft {
            from {
                transform: translateX(-20px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-family: 'Roboto', Arial, sans-serif;
            transition: all 0.3s ease;
        }
        .example-text {
            color: gray;
            font-style: italic;
            opacity: 0.7;
            font-size: 0.875em;
        }

        input:focus, select:focus, textarea:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 8px rgba(76, 175, 80, 0.6);
        }
        textarea {
            resize: none;
        }
        canvas {
            border: 1px solid #000;
            margin-bottom: 15px;
            transition: border-color 0.3s ease;
        }
        canvas:focus {
            border-color: #4CAF50;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            font-family: 'Roboto', Arial, sans-serif;
            font-weight: 500;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        button:hover {
            background-color: #45a049;
            transform: scale(1.05);
    
        }
        #clearSignature {
            background-color: #ff6347;
        }
        .button-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }
        .left-buttons {
            display: flex;
            gap: 10px;
        }
        input:placeholder-shown, textarea:placeholder-shown {
            background-color: #f0f8ff;
            border-color: #add8e6;
        }
        input:not(:placeholder-shown), textarea:not(:placeholder-shown) {
            background-color: white;
            border-color: #ddd;
        }
        .error {
            border-color: red !important;
        }
        #loadingSpinner {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #4CAF50;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        } 
        footer {
            text-align: center;
            padding: 10px;
            font-size: 14px;
            background: rgba(0, 0, 0, 0.05);
            margin-top: 20px;
            color: #333;
        }
        
        footer p {
        margin: 0;
        padding: 0;
        }
        
    </style>
</head>
<body>

<form id="alumniForm">
    <!-- Add the logo here -->
    <img src="https://raw.githubusercontent.com/ROWNIE77/RCAlumniforms/main/2.png" alt="Logo" class="logo">

    <h2>ALUMNI INFORMATION FORM</h2>
    <p style="text-align: justify; font-style: italic; font-family: 'Roboto', Arial, sans-serif;">
        <strong>Data Privacy Notice:</strong> In compliance with the Data Privacy Act of 2012 (RA 10173), we are committed to protecting your personal information. By clicking "Submit," you confirm that you voluntarily provide your data for the purpose of Alumni Data Collection.
    </p>
    <p style="text-align: justify; font-style: italic; font-family: 'Roboto', Arial, sans-serif;">
        Your information will be kept confidential and used only by Rogationist College for internal purposes, such as school records and communication.
    </p>
   
    <label for="firstName">First Name:</label>
    <input type="text" id="firstName" name="firstName" required placeholder="Enter your first name">

    <label for="lastName">Last Name:</label>
    <input type="text" id="lastName" name="lastName" required placeholder="Enter your last name">

    <label for="middleName">Middle Name:</label>
    <input type="text" id="middleName" name="middleName" placeholder="Enter your middle name">

    <label for="department">Department:</label>
    <select id="department" name="department" required>
        <option value="">Select Department</option>
        <option value="JHS">JHS</option>
        <option value="SHS">SHS</option>
        <option value="College">College</option>
        <option value="TED">TED</option>
    </select>

    <div id="strands" style="display:none;">
        <label for="strand">SHS Strand:</label>
        <select id="strand" name="strand">
            <option value="">Select Strand</option>
            <option value="ABM">ABM</option>
            <option value="STEM">STEM</option>
            <option value="HUMSS">GA - HUMSS</option>
        </select>
    </div>

    <div id="courses" style="display:none;">
        <label for="course">College Course:</label>
        <select id="course" name="course">
            <!-- Courses will be populated by JavaScript -->
        </select>
    </div>

    <label for="batch">Batch:</label>
    <select id="batch" name="batch" required>
        <!-- Years will be populated by JavaScript -->
    </select>

    <label for="section">Section:<span style="color: gray; font-style: italic; opacity: 0.7; font-size: smaller;";>(ex: St. Hannibal)</span></label>
    <input type="text" id="section" name="section" required placeholder="Enter your section">

    <label for="birthdate">Birthdate:</label>
    <input type="date" id="birthdate" name="birthdate" required placeholder="Enter your birthdate">

    <label for="phone">Phone Number:<span style="color: gray; font-style: italic; opacity: 0.7; font-size: smaller;";>(ex:09201231234)</span></label>
    <input type="tel" id="phone" name="phone" pattern="\d{11}" required placeholder="Enter your phone number">

    <label for="gmail">Gmail:</label>
    <input type="email" id="gmail" name="gmail" required placeholder="Enter your Gmail">

    <label for="address">Address:</label>
    <textarea id="address" name="address" required placeholder="Enter your address"></textarea>

    <label for="emergencyContact">Emergency Contact:</label>
    <input type="text" id="emergencyContact" name="emergencyContact" required placeholder="Enter emergency contact">

    <label for="emergencyPhone">Emergency Phone:<span style="color: gray; font-style: italic; opacity: 0.7; font-size: smaller;";>(ex:09201231234)</span></label>
    <input type="tel" id="emergencyPhone" name="emergencyPhone" pattern="\d{11}" required placeholder="Enter emergency phone">

    <label for="emergencyAddress">Emergency Address:</label>
    <textarea id="emergencyAddress" name="emergencyAddress" required placeholder="Enter emergency address"></textarea>

    <label for="signature">Signature:</label>
    <canvas id="signatureCanvas" width="300" height="150"></canvas>
    <input type="hidden" id="signatureData" name="Signature (Base64)">
   
    <!-- Suggestion Box -->
    <label for="suggestion">Suggestion (Optional):</label>
    <textarea id="suggestion" name="suggestion" placeholder="Enter your suggestion"></textarea>
   
    <!-- Guide for submitting form -->
    <p style="text-align: center; font-style: italic; font-family: 'Roboto', Arial, sans-serif; font-size: smaller;">
        After clicking the <b>submit</b> button, please wait for the confirmation message to appear before clicking again. Clicking the <b>clear signature</b> will only reset the canvas and clicking the <b>reset form</b> will reset the whole form.
    </p>

    <!-- Buttons -->
        <div class="button-group">
            <div class="left-buttons">
                <button type="button" id="clearSignature">Clear Signature</button>
                <button type="submit" id="submitButton">Submit</button>
            </div>
            <div class="right-button">
                <button type="button" id="resetForm">Reset Form</button>
            </div>
        </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner">
        <div class="spinner"></div>
        <p>Submitting...</p>
    </div>
 
    <!-- Footer -->
    <footer>
        <p>Designed and Developed by
    </p> 
    <p><strong>JHON RONEL N. NERVEZA</strong>
    </p>
    <p><i>Rogationist College Office of External Affairs</i>
    </p>
    </footer>
</form>

<script>
    const form = document.getElementById('alumniForm');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const submitButton = document.getElementById('submitButton');

    // Validate form before submission
    const validateForm = () => {
        const requiredFields = form.querySelectorAll('[required]');
        let isValid = true;

        requiredFields.forEach(field => {
            if (!field.value.trim()) {
                isValid = false;
                field.classList.add('error'); // Highlight empty fields
            } else {
                field.classList.remove('error'); // Reset border color
            }
        });

        // Additional validation for phone number
        const phone = document.getElementById('phone').value;
        if (!/^\d{11}$/.test(phone)) {
            isValid = false;
            alert('Phone number must be 11 digits.');
        }

        return isValid;
    };

    // Form submission handler
    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        if (!validateForm()) {
            alert('Please fill out all required fields.');
            return; // Stop submission if validation fails
        }

        // Show loading spinner
        loadingSpinner.style.display = 'block';
        submitButton.disabled = true;

        try {
            const response = await fetch('https://script.google.com/macros/s/AKfycbwqHpRmHJRnbKdusYqqX_liKBo_40rrdDAWbltdLYkwPMbhZM6VbwZ3g06-dPVFQD300A/exec', {
                method: 'POST',
                body: new FormData(form),
            });
            const data = await response.json();
            if (data.result === 'success') {
                alert('Form submitted successfully!');
            } else {
                alert('Error submitting the form: ' + data.error);
            }
        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred while submitting the form.');
        } finally {
            // Hide loading spinner
            loadingSpinner.style.display = 'none';
            submitButton.disabled = false;
        }
    });

    // Signature functionality
    const canvas = document.getElementById('signatureCanvas');
    const ctx = canvas.getContext('2d');
    let isDrawing = false;

    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseout', stopDrawing);

    canvas.addEventListener('touchstart', startDrawing);
    canvas.addEventListener('touchmove', draw);
    canvas.addEventListener('touchend', stopDrawing);

    function startDrawing(e) {
        e.preventDefault();
        isDrawing = true;
        draw(e);
    }

    function draw(e) {
        if (!isDrawing) return;
        ctx.lineWidth = 2;
        ctx.lineCap = 'round';
        ctx.strokeStyle = '#000';

        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;

        let clientX, clientY;
        if (e.touches) {
            clientX = e.touches[0].clientX;
            clientY = e.touches[0].clientY;
        } else {
            clientX = e.clientX;
            clientY = e.clientY;
        }

        ctx.lineTo((clientX - rect.left) * scaleX, (clientY - rect.top) * scaleY);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo((clientX - rect.left) * scaleX, (clientY - rect.top) * scaleY);
    }

    function stopDrawing() {
        isDrawing = false;
        ctx.beginPath();
        document.getElementById('signatureData').value = canvas.toDataURL();
    }

    // Clear signature functionality
    document.getElementById('clearSignature').addEventListener('click', function() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        document.getElementById('signatureData').value = ''; // Clear the hidden input too
    });

    // Reset form functionality
    document.getElementById('resetForm').addEventListener('click', function() {
        document.getElementById('alumniForm').reset();
        // Reset the canvas for signature
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        document.getElementById('signatureData').value = ''; // Clear the hidden signature data input
    });

    // Populate batch years from 1991 to 2030
    const batch = document.getElementById('batch');
    for(let year = 1991; year <= 2030; year++) {
        let option = document.createElement('option');
        option.value = year;
        option.text = year;
        batch.appendChild(option);
    }

    // Department change handler
    const department = document.getElementById('department');
    const strandsDiv = document.getElementById('strands');
    const coursesDiv = document.getElementById('courses');
    const courseSelect = document.getElementById('course');

    department.addEventListener('change', function() {
        strandsDiv.style.display = 'none';
        coursesDiv.style.display = 'none';
        if (this.value === 'SHS') {
            strandsDiv.style.display = 'block';
        } else if (this.value === 'College') {
            coursesDiv.style.display = 'block';
            populateCourses();
        }
    });

    function populateCourses() {
        const courses = [
            "Bachelor of Science in Accountancy",
            "Bachelor of Science in Business Administration Major in Marketing Management",
            "Bachelor of Science in Hospitality Management",
            "Bachelor of Science in Tourism Management",
            "Bachelor of Science in Information Technology",
            "Bachelor of Science in Electronics Engineering",
            "Bachelor of Science in Industrial Technology Major in Automotive Technology",
            "Bachelor of Science in Industrial Technology Major in Mechanical Technology",
            "Bachelor of Secondary Education Major in English",
            "Bachelor of Elementary Education"
        ];
        courseSelect.innerHTML = '<option value="">Select Course</option>';
        courses.forEach(course => {
            let option = document.createElement('option');
            option.value = course;
            option.text = course;
            courseSelect.appendChild(option);
        });
    }
</script>

</body>
</html>
